<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; CHARSET=UTF-8">
        <link rel="stylesheet" href="./../lib/jquery-ui-1.10.3/themes/base/jquery-ui.css" />
        <link rel="stylesheet" href="../css/vk2/tools/TimeSlider.css" /> 
        <link rel="stylesheet" href="../css/vk2/tools/TimeViewer.css" />
	<style>
		#map{
			position: absolute;
		    height: 100%;
		    width: 100%;
		}
		
		.testBtn{
			position: absolute;
			right:0px;
			top:150px;
			z-index: 1000;
		}
		
		.vk2TimeViewerPanel{
			position: absolute;
			right:20px;
			bottom:20px;
		}
		
		.loadingScreen{
			position: absolute;
			left: 50%;
			top: 30%;
			margin-left: -150px;
			margin-right: -150px;
			width: 300px;
			height: 50px;
			padding: 10px;
			z-index: 1000;
			color: white;
			background-color: rgb(173,167,158);
			opacity: 0.8;
		}
	</style>
        <script src="../lib/jquery-ui-1.10.3/jquery-1.9.1.js"></script>
        <script src="../lib/jquery-ui-1.10.3/ui/jquery-ui.js"></script>  
        <script src="../lib/OpenLayers-2.13.1/OpenLayers.js" type="text/javascript"></script>    
        <script src="../lib/vk2/utils.js" type="text/javascript"></script>
        <script src="../lib/vk2/tools/TimeSlider.js" type="text/javascript"></script>
        <script src="../lib/vk2/tools/TimeViewer.js" type="text/javascript"></script> 
        <script src="../lib/vk2/dev/tools.js" type="text/javascript"></script>
        <script src="http://maps.google.com/maps/api/js?v=3.2&sensor=false"></script>
        <script type="text/javascript">
        	OpenLayers.ProxyHost = "http://localhost:8080/proxy/?url=";;
        	var map = null;
            
        	var getTimeLayer = function(timestamp, map){
        		
	    		var timeLayer = new OpenLayers.Layer.WMS('Historische_Messtischblaetter_'+timestamp,
	    				'http://194.95.145.43/cgi-bin/mtbows',
	    				{
	    					layers:  'Historische Messtischblaetter',
	                        type:	"png",
	                        format: "image/png",
	                        transparent: 'true',
	                        time: timestamp, 
	                        tiled: true
	                    },{
	                    	isBaseLayer: false,
	                        visibility: true,
	                        transparent: 'true',
	                        opacity: 0,
	                        //displayInLayerSwitcher: false,
	                        projection: map.getProjectionObject(),
	                        maxExtent: map.getExtent(),
	            });
        		return timeLayer;
        	}
    		
            $(document).ready(function(){
            	
            	// initialize map and zoom to extent from saxony
				map = getMap('map');
				map.zoomToExtent(new OpenLayers.Bounds(1526747.988868,6582561.0980844,1623440.8296352,6631862.9813214));
				
				// add layer switcher
				var control = new OpenLayers.Control.LayerSwitcher();
				map.addControl(control);
				control.activate();
				
				$('#btn').button().click(function(){
					for (var i = 1908; i <= 1912; i++){
						map.addLayer(getTimeLayer(i, map));
					}
					console.log('Done!');
				});
            });
        </script>
    </head>
    <body>
	<div id="map"></div>
	<button id="btn" class="btn" style="position:absolute;bottom:200px;left:0px;z-index:1000;">Test</button>
	<div id="vk2TimeViewerPanel" class="vk2TimeViewerPanel">
	
	</div>
	<div id='loadingScreen' class='loadingScreen'>Bitten warten Sie. Ihr raumzeitliche Reise wird vorbereitet.</div>
    </body>
</html>
