<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; CHARSET=UTF-8">
        <link rel="stylesheet" href="./../lib/jquery-ui-1.10.3/themes/base/jquery-ui.css" />
        <link rel="stylesheet" href="../css/vk2/tools/TimeSlider.css" /> 
        <link rel="stylesheet" href="../css/vk2/tools/TimeViewer.css" />
	<style>
		#map{
			position: absolute;
		    height: 100%;
		    width: 100%;
		}
		
		.testBtn{
			position: absolute;
			right:0px;
			top:150px;
			z-index: 1000;
		}
		
		.vk2TimeViewerPanel{
			position: absolute;
			right:20px;
			bottom:20px;
		}
	</style>
        <script src="../lib/jquery-ui-1.10.3/jquery-1.9.1.js"></script>
        <script src="../lib/jquery-ui-1.10.3/ui/jquery-ui.js"></script>  
        <script src="../lib/OpenLayers-2.13.1/OpenLayers.js" type="text/javascript"></script>    
        <script src="http://maps.google.com/maps/api/js?v=3.2&sensor=false"></script>
        <script src="../js/Utils.js" type="text/javascript"></script>
        <script src="../js/tools/TimeSlider.js" type="text/javascript"></script>
        <script src="../js/tools/TimeViewer.js" type="text/javascript"></script> 
        <script src="../js/dev/tools.js" type="text/javascript"></script>
        <script type="text/javascript">
        	OpenLayers.ProxyHost = "http://localhost:8080/vkviewer/proxy/?url=";;
        	OpenLayers.IMAGE_RELOAD_ATTEMPTS = 5;
        	
        	var map = null;
        	var cacheReadLocal = null;
        	var cacheReadRemote = null;
        	var cacheWrite = null;
            
            $(document).ready(function(){
            	
            	// initialize map and zoom to extent from saxony
				map = getMap('map');
				map.zoomToExtent(new OpenLayers.Bounds(1526747.988868,6582561.0980844,1623440.8296352,6631862.9813214));
				
				// add layer switcher
				var control = new OpenLayers.Control.LayerSwitcher();
				map.addControl(control);
				control.activate();
				
				// cache tests
				// runs with mapnik layer, but cache is to small
/*  				cacheWrite = new OpenLayers.Control.CacheWrite({
					autoActivate: true,
					imageFormat: 'image/jpeg',
					eventListeners: {
						cachefull: function(){
							console.log('Cache full!');
						}
					}
				})
				map.addControl(cacheWrite);
				map.layers[0].events.on({'tileloaded': updateStatus});
				function updateStatus(){
					if (window.localStorage) {
						console.log(localStorage.length + ' entries in cache.');
					} else {
						console.log('Local storage not supported. Try a different browser.');
					}
				}   */
				
				var timeWmsController = TimeWmsController({
					contentDiv: document.getElementById('vk2TimeViewerPanel'),
					time_steps_legend: 1,
					timeWmsModule: TimeWmsModule({
						wms_url: 'http://194.95.145.43/mapcache', //'http://194.95.145.43/cgi-bin/mtbows', //'http://localhost/mapcache',
						layer: 'messtischblaetter',//'Historische Messtischblaetter', //'messtischblaetter',
						start_time: 1908,
						end_time: 1914,
						map: map
					})
				});
				
            });
        </script>
    </head>
    <body>
	<div id="map"></div>
	<div id="vk2TimeViewerPanel" class="vk2TimeViewerPanel">
	
	</div>
	<div id="sliderPanel" class="sliderPanel">
		<div id="sliderContainer" class="sliderContainer"></div>
	</div>
	
    </body>
</html>
