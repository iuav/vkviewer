<!DOCTYPE html>
<html>
    <head>
        <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=UTF-8">
        <title>Start Georeferenzierung</title>
        <link rel="stylesheet" type="text/css" href="./lib/jquery-ui-1.10.3/themes/base/jquery-ui.css" />
        <style>
        </style>
    </head>
 	<body>
 		<h2>Wähle Karte für Georeferenzierung<h2>
 	    <script src="./lib/jquery-ui-1.10.3/jquery-1.9.1.js" type="text/javascript"></script>
        <script src="./lib/jquery-ui-1.10.3/ui/jquery-ui.js" type="text/javascript"></script>  
        <script src="./lib/vk2/utils.js" type="text/javascript"></script>  
        <script>
        	var 
        	$(document).ready(function(){
        		// parse blattnr from get parameter
        		var blattnr = get_url_param('blattnr');
        		
        		// get mtb / layer / wms / titel for blattnr via ajax call
        		$.ajax({
        			'url' : getHost('vkviewer/getwms'),
        			'type' : 'GET',
        			'data' : {
        				'blattnr' : blattnr 
        			},
        			'success' : function(data){
        				// parse the json response and create for every mtb an anchor
        				jsonObj = $.parseJSON(data)
        				for (var i = 0, len = jsonObj.length; i < len; i++){
        					var mtb = jsonObj[i]
        					var anchor = document.createElement('a');
        					var zoomifyUrl = getZoomifyUrl(mtb.zoomify_prop)
        					//var href = getHost('vkviewer/static/georeference.html') 
        					var href = getHost('vkviewer/auth')
        							+ "?mtbid=" + mtb.mtbid +
        							"&zoomify_url=" + zoomifyUrl + "&zoomify_width=" + mtb.zoomify_width +
        							"&zoomify_height=" + mtb.zoomify_height;
        					anchor.href = href;
        					anchor.target = '_top';
        					anchor.innerHTML = mtb.titel;
							document.body.appendChild(anchor);
							document.body.appendChild(document.createElement('br'));
        				}
        			}
        		});
        	});
        </script>
 	</body>
</html>